<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Alpha Vantage 주식 가격 조회</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; margin-top: 50px; background-color: #f4f7f6; }
        .stock-container { 
            border: 2px solid #007bff; 
            border-radius: 10px; 
            padding: 30px; 
            max-width: 450px; 
            margin: 20px auto; 
            background-color: white; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); 
        }
        .stock-container h1 { color: #007bff; margin-bottom: 20px; }
        .price { font-size: 2.5em; font-weight: bold; color: #28a745; margin-top: 10px; }
        .meta { color: #6c757d; font-size: 0.9em; }
        button { 
            background-color: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin-top: 20px; 
        }
    </style>
</head>
<body>
    <h1>실시간 주식 가격 조회 (Alpha Vantage Open API)</h1>
    <div class="stock-container">
        <h2 id="symbol-display">-- 종목 --</h2>
        <div id="price-display" class="price">데이터 로드 중...</div>
        <p id="time-display" class="meta"></p>
        <button onclick="getStockData()">가격 새로고침</button>
    </div>

    <script>
        // === 사용자 정보 설정 ===
        // 1. 발급받은 Alpha Vantage API 키를 여기에 입력하세요.
        const API_KEY = O5BID7S51RM1Q3D9; 
        // 2. 조회하고 싶은 주식 심볼을 설정하세요.
        const STOCK_SYMBOL = "AAPL"; 
        // ======================

        document.getElementById('symbol-display').textContent = `종목: ${STOCK_SYMBOL}`;
        
        function getStockData() {
            const FUNCTION = "GLOBAL_QUOTE"; // 실시간 단일 주식 가격 조회 기능
            
            // Alpha Vantage API 호출 URL 생성
            const url = `https://www.alphavantage.co/query?function=${FUNCTION}&symbol=${STOCK_SYMBOL}&apikey=${API_KEY}`;
            
            const priceDisplay = document.getElementById('price-display');
            const timeDisplay = document.getElementById('time-display');

            priceDisplay.textContent = '데이터를 불러오는 중...';
            timeDisplay.textContent = '';

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    // API 응답 구조 확인 (주식 정보는 Global Quote 키에 있음)
                    const quote = data["Global Quote"];

                    if (!quote || Object.keys(quote).length === 0) {
                        priceDisplay.textContent = '데이터 없음';
                        timeDisplay.textContent = '종목 심볼 또는 API 키를 확인하세요.';
                        console.error('API 응답 오류:', data);
                        return;
                    }

                    // 필요한 데이터 추출
                    const price = quote["05. price"];
                    const lastRefreshed = quote["07. latest trading day"];

                    // 결과 표시
                    priceDisplay.textContent = `$${parseFloat(price).toFixed(2)}`;
                    timeDisplay.textContent = `최신 데이터 날짜: ${lastRefreshed}`;
                })
                .catch(error => {
                    console.error('API 호출 중 오류:', error);
                    priceDisplay.textContent = '오류 발생';
                    timeDisplay.textContent = '네트워크 또는 API 호출에 문제가 있습니다.';
                });
        }

        // 페이지 로드 시 바로 데이터 로드 시작
        getStockData();
    </script>
</body>
</html>